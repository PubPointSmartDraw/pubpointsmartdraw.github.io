{"ast":null,"code":"import _regeneratorRuntime from \"/media/audric/Data/Document/PubPoint/dev/sources/React/PubPointSmartDraw/finalApp/pubpointsmartdraw/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/media/audric/Data/Document/PubPoint/dev/sources/React/PubPointSmartDraw/finalApp/pubpointsmartdraw/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/media/audric/Data/Document/PubPoint/dev/sources/React/PubPointSmartDraw/finalApp/pubpointsmartdraw/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/media/audric/Data/Document/PubPoint/dev/sources/React/PubPointSmartDraw/finalApp/pubpointsmartdraw/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/media/audric/Data/Document/PubPoint/dev/sources/React/PubPointSmartDraw/finalApp/pubpointsmartdraw/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/media/audric/Data/Document/PubPoint/dev/sources/React/PubPointSmartDraw/finalApp/pubpointsmartdraw/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/media/audric/Data/Document/PubPoint/dev/sources/React/PubPointSmartDraw/finalApp/pubpointsmartdraw/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/media/audric/Data/Document/PubPoint/dev/sources/React/PubPointSmartDraw/finalApp/pubpointsmartdraw/src/pubpoint-studio/components/specific-components/BaseCanvasKonvaAnimatedObject.js\";\n\n/*****************************************************************************\n *\n * PubPoint Smart Draw Web application\n *\n * Developed for PubPoint Strategy by Eng. FEUYAN TCHOUO\n *\n * Copyright (C) PubPoint Strategy - All rights reserved.\n * Unauthorized copying of this file, via any medium is strictly prohibited.\n * Proprietary and confidential.\n * Written by FEUYAN TCHOUO <tca1audricfeuyan@gmail.com>, November 2018.\n *\n *****************************************************************************\n */\nimport React, { Component } from 'react';\nimport { Text, Rect, Circle, Ellipse, RegularPolygon } from 'react-konva';\nimport { Spring, Keyframes, config } from 'react-spring/dist/konva';\nimport delay from 'delay';\nimport BaseCanvasKonvaImage from './BaseCanvasKonvaImage';\nimport { GEOMETRIC_FORMS, ANIMATION_EFFECTS } from '../Constants';\nimport ErrorBoundary from \"./ErrorBoundary\";\nvar effectValue = ANIMATION_EFFECTS.fr;\n/**\n* Composant responsable du rendu des images animées.\n*/\n\nvar BaseCanvasKonvaAnimatedObject =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(BaseCanvasKonvaAnimatedObject, _Component);\n\n  /**\n  * Variable d'état du composant.\n  */\n\n  /**\n  * Constructeur du composant.\n  * @constructor\n  */\n  function BaseCanvasKonvaAnimatedObject(props) {\n    var _this;\n\n    _classCallCheck(this, BaseCanvasKonvaAnimatedObject);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(BaseCanvasKonvaAnimatedObject).call(this, props));\n    _this.state = {\n      fromValue: {},\n      toValue: {},\n      currentObject: {},\n      reverseSpring: false\n    };\n\n    _this.doNothing = function () {};\n\n    _this.updateAnimationFromValue = function () {\n      _this.newX = _this.currentObject.x / _this.props.creationBoardWidth * _this.props.windowWidth;\n      _this.newY = _this.currentObject.y / _this.props.creationBoardHeight * _this.props.windowHeight;\n      _this.newWidth = _this.currentObject.width / _this.props.creationBoardWidth * _this.props.windowWidth;\n      _this.newHeight = _this.currentObject.height / _this.props.creationBoardHeight * _this.props.windowHeight;\n      var enterEffect = _this.currentObject.enterEffect;\n      var xpos = 0,\n          ypos = 0;\n\n      switch (enterEffect) {\n        case effectValue.FROMRIGHT:\n          xpos = _this.props.windowWidth + _this.newWidth * 1.1;\n\n          _this.setState({\n            fromValue: {\n              x: xpos\n            }\n          });\n\n          break;\n\n        case effectValue.FROMLEFT:\n          xpos = -_this.newWidth * 1.1;\n\n          _this.setState({\n            fromValue: {\n              x: xpos\n            }\n          });\n\n          break;\n\n        case effectValue.FROMTOP:\n          ypos = -_this.newHeight * 1.1;\n\n          _this.setState({\n            fromValue: {\n              y: ypos\n            }\n          });\n\n          break;\n\n        case effectValue.FROMBOTTOM:\n          ypos = _this.props.windowHeight + _this.newHeight * 1.1;\n\n          _this.setState({\n            fromValue: {\n              y: ypos\n            }\n          });\n\n          break;\n\n        case effectValue.DEFAULT:\n          _this.setState({\n            fromValue: {\n              opacity: 0\n            }\n          });\n\n          break;\n\n        default:\n          _this.setState({\n            fromValue: {\n              opacity: 0\n            }\n          });\n\n      }\n    };\n\n    _this.updateAnimationToValue = function () {\n      _this.setState({\n        toValue: {\n          x: _this.newX,\n          y: _this.newY,\n          width: _this.newWidth,\n          height: _this.newHeight,\n          rotation: _this.currentObject.rotation,\n          opacity: 1\n        }\n      });\n    };\n\n    _this.state = {\n      fromValue: {},\n      toValue: {},\n      currentObject: {}\n    };\n    return _this;\n  }\n  /**\n  * Fonction de la phase \"Avant montage\" du cycle de vie du composant.\n  */\n\n\n  _createClass(BaseCanvasKonvaAnimatedObject, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.currentObject = this.props.animatedObject;\n      this.updateAnimationFromValue();\n      this.updateAnimationToValue();\n    }\n    /**\n    * Fonction de la phase \"Avant démontage\" du cycle de vie du composant.\n    */\n\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {}\n    /**\n    * Fonction ayant la responsabilité de faire rien du tout.\n    */\n\n  }, {\n    key: \"render\",\n\n    /**\n    * Affiche les éléments d'interface du composant.\n    */\n    value: function render() {\n      var _this2 = this;\n\n      var toValue = this.state.toValue,\n          fromValue = this.state.fromValue,\n          entranceDelay = this.currentObject.entranceDelay,\n          entranceDuration = this.currentObject.entranceDuration,\n          exitDelay = this.currentObject.exitDelay,\n          exitDuration = this.currentObject.exitDuration;\n      /*console.log(fromValue);\n      console.log(toValue);\n      console.log(this.props.animatedObject.entranceDelay);\n      console.log(this.props.animatedObject.entranceDuration);*/\n\n      var PubPointAnimator = Keyframes.Spring(\n      /*#__PURE__*/\n      function () {\n        var _ref = _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee(next, cancel, ownProps) {\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _context.next = 2;\n                  return delay(entranceDelay);\n\n                case 2:\n                  _context.next = 4;\n                  return next({\n                    from: fromValue,\n                    to: toValue,\n                    duration: entranceDuration\n                  });\n\n                case 4:\n                  _context.next = 6;\n                  return delay(exitDelay);\n\n                case 6:\n                  _context.next = 8;\n                  return next({\n                    from: toValue,\n                    to: fromValue,\n                    duration: exitDuration\n                  });\n\n                case 8:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, this);\n        }));\n\n        return function (_x, _x2, _x3) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n\n      var animationRenderer = function animationRenderer() {\n        var objectType = _this2.props.type;\n\n        switch (objectType) {\n          case \"character\":\n            console.log(\"Character\");\n            return React.createElement(PubPointAnimator, {\n              onFrame: _this2.props.captureFrameCallback,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 153\n              },\n              __self: this\n            }, function (props) {\n              return React.createElement(BaseCanvasKonvaImage, Object.assign({\n                imageSrc: _this2.currentObject.image,\n                type: _this2.currentObject.type,\n                assetIndex: _this2.props.objectIndex,\n                onAssetClicked: _this2.doNothing,\n                onPositionChange: _this2.doNothing,\n                onTransformChange: _this2.doNothing\n              }, props, {\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 154\n                },\n                __self: this\n              }));\n            });\n\n          case \"object\":\n            return React.createElement(PubPointAnimator, {\n              onFrame: _this2.props.captureFrameCallback,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 164\n              },\n              __self: this\n            }, function (props) {\n              return React.createElement(BaseCanvasKonvaImage, Object.assign({\n                imageSrc: _this2.currentObject.image,\n                type: _this2.currentObject.type,\n                assetIndex: _this2.props.objectIndex,\n                onAssetClicked: _this2.doNothing,\n                onPositionChange: _this2.doNothing,\n                onTransformChange: _this2.doNothing\n              }, props, {\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 165\n                },\n                __self: this\n              }));\n            });\n\n          case \"landscape\":\n            return React.createElement(PubPointAnimator, {\n              onFrame: _this2.props.captureFrameCallback,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 175\n              },\n              __self: this\n            }, function (props) {\n              return React.createElement(BaseCanvasKonvaImage, Object.assign({\n                imageSrc: _this2.currentObject.image,\n                type: _this2.currentObject.type,\n                assetIndex: _this2.props.objectIndex,\n                onAssetClicked: _this2.doNothing,\n                onPositionChange: _this2.doNothing,\n                onTransformChange: _this2.doNothing\n              }, props, {\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 176\n                },\n                __self: this\n              }));\n            });\n\n          case GEOMETRIC_FORMS.fr.RECTANGLE:\n            console.log(GEOMETRIC_FORMS.fr.RECTANGLE);\n            return React.createElement(PubPointAnimator, {\n              onFrame: _this2.props.captureFrameCallback,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 187\n              },\n              __self: this\n            }, function (props) {\n              return React.createElement(Rect, Object.assign({}, props, {\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 188\n                },\n                __self: this\n              }));\n            });\n\n          case GEOMETRIC_FORMS.fr.CIRCLE:\n            return React.createElement(Circle, {\n              x: parseInt(_this2.props.x),\n              y: parseInt(_this2.props.y),\n              radius: parseInt(_this2.props.radius),\n              fill: _this2.props.fill,\n              stroke: _this2.props.stroke,\n              strokeWidth: parseInt(_this2.props.strokeWidth),\n              className: \"GeometricForm\",\n              onPositionChange: _this2.props.onPositionChange,\n              onTransformChange: _this2.props.onTransformChange,\n              onClick: _this2.props.onAssetClicked,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 192\n              },\n              __self: this\n            });\n\n          case GEOMETRIC_FORMS.fr.ELLIPSE:\n            return React.createElement(Ellipse, {\n              x: parseInt(_this2.props.x),\n              y: parseInt(_this2.props.y),\n              radius: {\n                x: parseInt(_this2.props.radiusX),\n                y: parseInt(_this2.props.radiusY)\n              },\n              fill: _this2.props.fill,\n              stroke: _this2.props.stroke,\n              strokeWidth: parseInt(_this2.props.strokeWidth),\n              className: \"GeometricForm\",\n              onPositionChange: _this2.props.onPositionChange,\n              onTransformChange: _this2.props.onTransformChange,\n              onClick: _this2.props.onAssetClicked,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 204\n              },\n              __self: this\n            });\n\n          case GEOMETRIC_FORMS.fr.REGULARPOLYGON:\n            return React.createElement(RegularPolygon, {\n              x: parseInt(_this2.props.x),\n              y: parseInt(_this2.props.y),\n              sides: parseInt(_this2.props.sides),\n              radius: parseInt(_this2.props.radius),\n              fill: _this2.props.fill,\n              stroke: _this2.props.stroke,\n              strokeWidth: parseInt(_this2.props.strokeWidth),\n              className: \"GeometricForm\",\n              onPositionChange: _this2.props.onPositionChange,\n              onTransformChange: _this2.props.onTransformChange,\n              onClick: _this2.props.onAssetClicked,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 216\n              },\n              __self: this\n            });\n\n          case \"textfield\":\n            return React.createElement(Text, {\n              fontSize: parseInt(_this2.props.fontSize),\n              text: _this2.props.inputText,\n              fill: _this2.props.color,\n              x: parseInt(_this2.props.xValue),\n              y: parseInt(_this2.props.yValue),\n              fontFamily: _this2.props.fontFamily,\n              align: _this2.props.align,\n              width: parseInt(_this2.props.width),\n              name: _this2.props.name,\n              type: _this2.props.type,\n              className: \"Textfield\",\n              onPositionChange: _this2.props.onPositionChange,\n              onTransformChange: _this2.props.onTransformChange,\n              onClick: _this2.props.onAssetClicked,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 229\n              },\n              __self: this\n            });\n        }\n      };\n\n      return React.createElement(ErrorBoundary, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 247\n        },\n        __self: this\n      }, animationRenderer());\n    }\n  }]);\n\n  return BaseCanvasKonvaAnimatedObject;\n}(Component);\n\nexport default BaseCanvasKonvaAnimatedObject;","map":{"version":3,"sources":["/media/audric/Data/Document/PubPoint/dev/sources/React/PubPointSmartDraw/finalApp/pubpointsmartdraw/src/pubpoint-studio/components/specific-components/BaseCanvasKonvaAnimatedObject.js"],"names":["React","Component","Text","Rect","Circle","Ellipse","RegularPolygon","Spring","Keyframes","config","delay","BaseCanvasKonvaImage","GEOMETRIC_FORMS","ANIMATION_EFFECTS","ErrorBoundary","effectValue","fr","BaseCanvasKonvaAnimatedObject","props","state","fromValue","toValue","currentObject","reverseSpring","doNothing","updateAnimationFromValue","newX","x","creationBoardWidth","windowWidth","newY","y","creationBoardHeight","windowHeight","newWidth","width","newHeight","height","enterEffect","xpos","ypos","FROMRIGHT","setState","FROMLEFT","FROMTOP","FROMBOTTOM","DEFAULT","opacity","updateAnimationToValue","rotation","animatedObject","entranceDelay","entranceDuration","exitDelay","exitDuration","PubPointAnimator","next","cancel","ownProps","from","to","duration","animationRenderer","objectType","type","console","log","captureFrameCallback","image","objectIndex","RECTANGLE","CIRCLE","parseInt","radius","fill","stroke","strokeWidth","onPositionChange","onTransformChange","onAssetClicked","ELLIPSE","radiusX","radiusY","REGULARPOLYGON","sides","fontSize","inputText","color","xValue","yValue","fontFamily","align","name"],"mappings":";;;;;;;;;AAAA;;;;;;;;;;;;;AAaA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,IAAT,EAAeC,IAAf,EAAqBC,MAArB,EAA6BC,OAA7B,EAAsCC,cAAtC,QAA4D,aAA5D;AACA,SAASC,MAAT,EAAiBC,SAAjB,EAA4BC,MAA5B,QAA0C,yBAA1C;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,OAAOC,oBAAP,MAAiC,wBAAjC;AACA,SAAUC,eAAV,EAA2BC,iBAA3B,QAAoD,cAApD;AACA,OAAOC,aAAP,MAA0B,iBAA1B;AAEA,IAAMC,WAAW,GAAGF,iBAAiB,CAACG,EAAtC;AAEA;;;;IAGMC,6B;;;;;AACJ;;;;AAWA;;;;AAIA,yCAAYC,KAAZ,EAAkB;AAAA;;AAAA;;AAChB,uGAAMA,KAAN;AADgB,UAZlBC,KAYkB,GAZV;AACNC,MAAAA,SAAS,EAAG,EADN;AAENC,MAAAA,OAAO,EAAG,EAFJ;AAGNC,MAAAA,aAAa,EAAG,EAHV;AAINC,MAAAA,aAAa,EAAE;AAJT,KAYU;;AAAA,UA2BlBC,SA3BkB,GA2BN,YAAM,CAAE,CA3BF;;AAAA,UAgClBC,wBAhCkB,GAgCS,YAAM;AAC/B,YAAKC,IAAL,GAAa,MAAKJ,aAAL,CAAmBK,CAAnB,GAAqB,MAAKT,KAAL,CAAWU,kBAAjC,GAAqD,MAAKV,KAAL,CAAWW,WAA5E;AACA,YAAKC,IAAL,GAAa,MAAKR,aAAL,CAAmBS,CAAnB,GAAqB,MAAKb,KAAL,CAAWc,mBAAjC,GAAsD,MAAKd,KAAL,CAAWe,YAA7E;AACA,YAAKC,QAAL,GAAiB,MAAKZ,aAAL,CAAmBa,KAAnB,GAAyB,MAAKjB,KAAL,CAAWU,kBAArC,GAAyD,MAAKV,KAAL,CAAWW,WAApF;AACA,YAAKO,SAAL,GAAkB,MAAKd,aAAL,CAAmBe,MAAnB,GAA0B,MAAKnB,KAAL,CAAWc,mBAAtC,GAA2D,MAAKd,KAAL,CAAWe,YAAvF;AAEA,UAAMK,WAAW,GAAG,MAAKhB,aAAL,CAAmBgB,WAAvC;AACA,UAAIC,IAAI,GAAG,CAAX;AAAA,UAAcC,IAAI,GAAG,CAArB;;AACA,cAAOF,WAAP;AACE,aAAKvB,WAAW,CAAC0B,SAAjB;AACEF,UAAAA,IAAI,GAAG,MAAKrB,KAAL,CAAWW,WAAX,GAAyB,MAAKK,QAAL,GAAc,GAA9C;;AACA,gBAAKQ,QAAL,CAAc;AAAEtB,YAAAA,SAAS,EAAG;AAAEO,cAAAA,CAAC,EAACY;AAAJ;AAAd,WAAd;;AACA;;AACF,aAAKxB,WAAW,CAAC4B,QAAjB;AACEJ,UAAAA,IAAI,GAAG,CAAC,MAAKL,QAAN,GAAe,GAAtB;;AACA,gBAAKQ,QAAL,CAAc;AAAEtB,YAAAA,SAAS,EAAG;AAAEO,cAAAA,CAAC,EAACY;AAAJ;AAAd,WAAd;;AACA;;AACF,aAAKxB,WAAW,CAAC6B,OAAjB;AACEJ,UAAAA,IAAI,GAAG,CAAC,MAAKJ,SAAN,GAAgB,GAAvB;;AACA,gBAAKM,QAAL,CAAc;AAAEtB,YAAAA,SAAS,EAAG;AAAEW,cAAAA,CAAC,EAACS;AAAJ;AAAd,WAAd;;AACA;;AACF,aAAKzB,WAAW,CAAC8B,UAAjB;AACEL,UAAAA,IAAI,GAAG,MAAKtB,KAAL,CAAWe,YAAX,GAA0B,MAAKG,SAAL,GAAe,GAAhD;;AACA,gBAAKM,QAAL,CAAc;AAAEtB,YAAAA,SAAS,EAAG;AAAEW,cAAAA,CAAC,EAACS;AAAJ;AAAd,WAAd;;AACA;;AACF,aAAKzB,WAAW,CAAC+B,OAAjB;AACE,gBAAKJ,QAAL,CAAc;AAAEtB,YAAAA,SAAS,EAAG;AAAE2B,cAAAA,OAAO,EAAC;AAAV;AAAd,WAAd;;AACA;;AACF;AACE,gBAAKL,QAAL,CAAc;AAAEtB,YAAAA,SAAS,EAAG;AAAE2B,cAAAA,OAAO,EAAC;AAAV;AAAd,WAAd;;AArBJ;AAuBD,KA/DiB;;AAAA,UAmElBC,sBAnEkB,GAmEQ,YAAM;AAC9B,YAAKN,QAAL,CAAc;AACZrB,QAAAA,OAAO,EAAE;AACPM,UAAAA,CAAC,EAAC,MAAKD,IADA;AAEPK,UAAAA,CAAC,EAAC,MAAKD,IAFA;AAGPK,UAAAA,KAAK,EAAC,MAAKD,QAHJ;AAIPG,UAAAA,MAAM,EAAC,MAAKD,SAJL;AAKPa,UAAAA,QAAQ,EAAC,MAAK3B,aAAL,CAAmB2B,QALrB;AAMPF,UAAAA,OAAO,EAAC;AAND;AADG,OAAd;AAUD,KA9EiB;;AAEhB,UAAK5B,KAAL,GAAa;AACXC,MAAAA,SAAS,EAAG,EADD;AAEXC,MAAAA,OAAO,EAAG,EAFC;AAGXC,MAAAA,aAAa,EAAG;AAHL,KAAb;AAFgB;AAOjB;AAED;;;;;;;yCAGoB;AAClB,WAAKA,aAAL,GAAqB,KAAKJ,KAAL,CAAWgC,cAAhC;AACA,WAAKzB,wBAAL;AACA,WAAKuB,sBAAL;AACD;AACD;;;;;;2CAGsB,CAErB;AAED;;;;;;;AAwDA;;;6BAGS;AAAA;;AACP,UAAI3B,OAAO,GAAG,KAAKF,KAAL,CAAWE,OAAzB;AAAA,UACID,SAAS,GAAG,KAAKD,KAAL,CAAWC,SAD3B;AAAA,UAEI+B,aAAa,GAAG,KAAK7B,aAAL,CAAmB6B,aAFvC;AAAA,UAGIC,gBAAgB,GAAG,KAAK9B,aAAL,CAAmB8B,gBAH1C;AAAA,UAIIC,SAAS,GAAG,KAAK/B,aAAL,CAAmB+B,SAJnC;AAAA,UAKIC,YAAY,GAAG,KAAKhC,aAAL,CAAmBgC,YALtC;AAOA;;;;;AAKA,UAAMC,gBAAgB,GAAG/C,SAAS,CAACD,MAAV;AAAA;AAAA;AAAA;AAAA;AAAA,iCACvB,iBAAOiD,IAAP,EAAaC,MAAb,EAAqBC,QAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBACQhD,KAAK,CAACyC,aAAD,CADb;;AAAA;AAAA;AAAA,yBAEQK,IAAI,CAAC;AAAEG,oBAAAA,IAAI,EAACvC,SAAP;AAAkBwC,oBAAAA,EAAE,EAACvC,OAArB;AAA8BwC,oBAAAA,QAAQ,EAACT;AAAvC,mBAAD,CAFZ;;AAAA;AAAA;AAAA,yBAGQ1C,KAAK,CAAC2C,SAAD,CAHb;;AAAA;AAAA;AAAA,yBAIQG,IAAI,CAAC;AAAEG,oBAAAA,IAAI,EAACtC,OAAP;AAAgBuC,oBAAAA,EAAE,EAACxC,SAAnB;AAA8ByC,oBAAAA,QAAQ,EAACP;AAAvC,mBAAD,CAJZ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SADuB;;AAAA;AAAA;AAAA;AAAA,UAAzB;;AAQA,UAAMQ,iBAAiB,GAAG,SAApBA,iBAAoB,GAAM;AAC9B,YAAIC,UAAU,GAAG,MAAI,CAAC7C,KAAL,CAAW8C,IAA5B;;AACA,gBAAOD,UAAP;AACE,eAAK,WAAL;AACAE,YAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;AACC,mBAAO,oBAAC,gBAAD;AAAkB,cAAA,OAAO,EAAE,MAAI,CAAChD,KAAL,CAAWiD,oBAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eACE,UAAAjD,KAAK;AAAA,qBAAI,oBAAC,oBAAD;AAAuB,gBAAA,QAAQ,EAAE,MAAI,CAACI,aAAL,CAAmB8C,KAApD;AACuB,gBAAA,IAAI,EAAE,MAAI,CAAC9C,aAAL,CAAmB0C,IADhD;AAEuB,gBAAA,UAAU,EAAE,MAAI,CAAC9C,KAAL,CAAWmD,WAF9C;AAGuB,gBAAA,cAAc,EAAE,MAAI,CAAC7C,SAH5C;AAIuB,gBAAA,gBAAgB,EAAE,MAAI,CAACA,SAJ9C;AAKuB,gBAAA,iBAAiB,EAAE,MAAI,CAACA;AAL/C,iBAM2BN,KAN3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAJ;AAAA,aADP,CAAP;;AAUA,eAAK,QAAL;AACC,mBAAO,oBAAC,gBAAD;AAAkB,cAAA,OAAO,EAAE,MAAI,CAACA,KAAL,CAAWiD,oBAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eACE,UAAAjD,KAAK;AAAA,qBAAI,oBAAC,oBAAD;AAAuB,gBAAA,QAAQ,EAAE,MAAI,CAACI,aAAL,CAAmB8C,KAApD;AACuB,gBAAA,IAAI,EAAE,MAAI,CAAC9C,aAAL,CAAmB0C,IADhD;AAEuB,gBAAA,UAAU,EAAE,MAAI,CAAC9C,KAAL,CAAWmD,WAF9C;AAGuB,gBAAA,cAAc,EAAE,MAAI,CAAC7C,SAH5C;AAIuB,gBAAA,gBAAgB,EAAE,MAAI,CAACA,SAJ9C;AAKuB,gBAAA,iBAAiB,EAAE,MAAI,CAACA;AAL/C,iBAM2BN,KAN3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAJ;AAAA,aADP,CAAP;;AAUA,eAAK,WAAL;AACC,mBAAO,oBAAC,gBAAD;AAAkB,cAAA,OAAO,EAAE,MAAI,CAACA,KAAL,CAAWiD,oBAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eACE,UAAAjD,KAAK;AAAA,qBAAI,oBAAC,oBAAD;AAAuB,gBAAA,QAAQ,EAAE,MAAI,CAACI,aAAL,CAAmB8C,KAApD;AACuB,gBAAA,IAAI,EAAE,MAAI,CAAC9C,aAAL,CAAmB0C,IADhD;AAEuB,gBAAA,UAAU,EAAE,MAAI,CAAC9C,KAAL,CAAWmD,WAF9C;AAGuB,gBAAA,cAAc,EAAE,MAAI,CAAC7C,SAH5C;AAIuB,gBAAA,gBAAgB,EAAE,MAAI,CAACA,SAJ9C;AAKuB,gBAAA,iBAAiB,EAAE,MAAI,CAACA;AAL/C,iBAM4BN,KAN5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAJ;AAAA,aADP,CAAP;;AAUA,eAAKN,eAAe,CAACI,EAAhB,CAAmBsD,SAAxB;AACCL,YAAAA,OAAO,CAACC,GAAR,CAAYtD,eAAe,CAACI,EAAhB,CAAmBsD,SAA/B;AACA,mBAAO,oBAAC,gBAAD;AAAkB,cAAA,OAAO,EAAE,MAAI,CAACpD,KAAL,CAAWiD,oBAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eACE,UAAAjD,KAAK;AAAA,qBAAI,oBAAC,IAAD,oBAAYA,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAJ;AAAA,aADP,CAAP;;AAIA,eAAKN,eAAe,CAACI,EAAhB,CAAmBuD,MAAxB;AACC,mBAAO,oBAAC,MAAD;AAAS,cAAA,CAAC,EAAEC,QAAQ,CAAC,MAAI,CAACtD,KAAL,CAAWS,CAAZ,CAApB;AACS,cAAA,CAAC,EAAE6C,QAAQ,CAAC,MAAI,CAACtD,KAAL,CAAWa,CAAZ,CADpB;AAES,cAAA,MAAM,EAAEyC,QAAQ,CAAC,MAAI,CAACtD,KAAL,CAAWuD,MAAZ,CAFzB;AAGS,cAAA,IAAI,EAAE,MAAI,CAACvD,KAAL,CAAWwD,IAH1B;AAIS,cAAA,MAAM,EAAE,MAAI,CAACxD,KAAL,CAAWyD,MAJ5B;AAKS,cAAA,WAAW,EAAEH,QAAQ,CAAC,MAAI,CAACtD,KAAL,CAAW0D,WAAZ,CAL9B;AAMS,cAAA,SAAS,EAAC,eANnB;AAOS,cAAA,gBAAgB,EAAE,MAAI,CAAC1D,KAAL,CAAW2D,gBAPtC;AAQS,cAAA,iBAAiB,EAAE,MAAI,CAAC3D,KAAL,CAAW4D,iBARvC;AASS,cAAA,OAAO,EAAE,MAAI,CAAC5D,KAAL,CAAW6D,cAT7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAP;;AAWF,eAAKnE,eAAe,CAACI,EAAhB,CAAmBgE,OAAxB;AACC,mBAAO,oBAAC,OAAD;AAAU,cAAA,CAAC,EAAER,QAAQ,CAAC,MAAI,CAACtD,KAAL,CAAWS,CAAZ,CAArB;AACU,cAAA,CAAC,EAAE6C,QAAQ,CAAC,MAAI,CAACtD,KAAL,CAAWa,CAAZ,CADrB;AAEU,cAAA,MAAM,EAAE;AAACJ,gBAAAA,CAAC,EAAE6C,QAAQ,CAAC,MAAI,CAACtD,KAAL,CAAW+D,OAAZ,CAAZ;AAAkClD,gBAAAA,CAAC,EAACyC,QAAQ,CAAC,MAAI,CAACtD,KAAL,CAAWgE,OAAZ;AAA5C,eAFlB;AAGU,cAAA,IAAI,EAAE,MAAI,CAAChE,KAAL,CAAWwD,IAH3B;AAIU,cAAA,MAAM,EAAE,MAAI,CAACxD,KAAL,CAAWyD,MAJ7B;AAKU,cAAA,WAAW,EAAEH,QAAQ,CAAC,MAAI,CAACtD,KAAL,CAAW0D,WAAZ,CAL/B;AAMU,cAAA,SAAS,EAAC,eANpB;AAOU,cAAA,gBAAgB,EAAE,MAAI,CAAC1D,KAAL,CAAW2D,gBAPvC;AAQU,cAAA,iBAAiB,EAAE,MAAI,CAAC3D,KAAL,CAAW4D,iBARxC;AASU,cAAA,OAAO,EAAE,MAAI,CAAC5D,KAAL,CAAW6D,cAT9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAP;;AAWD,eAAKnE,eAAe,CAACI,EAAhB,CAAmBmE,cAAxB;AACC,mBAAO,oBAAC,cAAD;AAAiB,cAAA,CAAC,EAAEX,QAAQ,CAAC,MAAI,CAACtD,KAAL,CAAWS,CAAZ,CAA5B;AACiB,cAAA,CAAC,EAAE6C,QAAQ,CAAC,MAAI,CAACtD,KAAL,CAAWa,CAAZ,CAD5B;AAEiB,cAAA,KAAK,EAAEyC,QAAQ,CAAC,MAAI,CAACtD,KAAL,CAAWkE,KAAZ,CAFhC;AAGiB,cAAA,MAAM,EAAEZ,QAAQ,CAAC,MAAI,CAACtD,KAAL,CAAWuD,MAAZ,CAHjC;AAIiB,cAAA,IAAI,EAAE,MAAI,CAACvD,KAAL,CAAWwD,IAJlC;AAKiB,cAAA,MAAM,EAAE,MAAI,CAACxD,KAAL,CAAWyD,MALpC;AAMiB,cAAA,WAAW,EAAEH,QAAQ,CAAC,MAAI,CAACtD,KAAL,CAAW0D,WAAZ,CANtC;AAOiB,cAAA,SAAS,EAAC,eAP3B;AAQiB,cAAA,gBAAgB,EAAE,MAAI,CAAC1D,KAAL,CAAW2D,gBAR9C;AASiB,cAAA,iBAAiB,EAAE,MAAI,CAAC3D,KAAL,CAAW4D,iBAT/C;AAUiB,cAAA,OAAO,EAAE,MAAI,CAAC5D,KAAL,CAAW6D,cAVrC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAP;;AAYA,eAAK,WAAL;AACC,mBAAO,oBAAC,IAAD;AAAO,cAAA,QAAQ,EAAEP,QAAQ,CAAC,MAAI,CAACtD,KAAL,CAAWmE,QAAZ,CAAzB;AACO,cAAA,IAAI,EAAE,MAAI,CAACnE,KAAL,CAAWoE,SADxB;AAEO,cAAA,IAAI,EAAE,MAAI,CAACpE,KAAL,CAAWqE,KAFxB;AAGO,cAAA,CAAC,EAAEf,QAAQ,CAAC,MAAI,CAACtD,KAAL,CAAWsE,MAAZ,CAHlB;AAIO,cAAA,CAAC,EAAEhB,QAAQ,CAAC,MAAI,CAACtD,KAAL,CAAWuE,MAAZ,CAJlB;AAKO,cAAA,UAAU,EAAE,MAAI,CAACvE,KAAL,CAAWwE,UAL9B;AAMO,cAAA,KAAK,EAAE,MAAI,CAACxE,KAAL,CAAWyE,KANzB;AAOO,cAAA,KAAK,EAAEnB,QAAQ,CAAC,MAAI,CAACtD,KAAL,CAAWiB,KAAZ,CAPtB;AAQO,cAAA,IAAI,EAAE,MAAI,CAACjB,KAAL,CAAW0E,IARxB;AASO,cAAA,IAAI,EAAE,MAAI,CAAC1E,KAAL,CAAW8C,IATxB;AAUO,cAAA,SAAS,EAAC,WAVjB;AAWO,cAAA,gBAAgB,EAAE,MAAI,CAAC9C,KAAL,CAAW2D,gBAXpC;AAYO,cAAA,iBAAiB,EAAE,MAAI,CAAC3D,KAAL,CAAW4D,iBAZrC;AAaO,cAAA,OAAO,EAAE,MAAI,CAAC5D,KAAL,CAAW6D,cAb3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAP;AA/EP;AA8FD,OAhGD;;AAkGA,aACE,oBAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACIjB,iBAAiB,EADrB,CADF;AAKD;;;;EA/NyC7D,S;;AAkO5C,eAAegB,6BAAf","sourcesContent":["/*****************************************************************************\n *\n * PubPoint Smart Draw Web application\n *\n * Developed for PubPoint Strategy by Eng. FEUYAN TCHOUO\n *\n * Copyright (C) PubPoint Strategy - All rights reserved.\n * Unauthorized copying of this file, via any medium is strictly prohibited.\n * Proprietary and confidential.\n * Written by FEUYAN TCHOUO <tca1audricfeuyan@gmail.com>, November 2018.\n *\n *****************************************************************************\n */\nimport React, { Component } from 'react';\nimport { Text, Rect, Circle, Ellipse, RegularPolygon } from 'react-konva';\nimport { Spring, Keyframes, config } from 'react-spring/dist/konva';\nimport delay from 'delay';\n\nimport BaseCanvasKonvaImage from './BaseCanvasKonvaImage';\nimport {  GEOMETRIC_FORMS, ANIMATION_EFFECTS } from '../Constants';\nimport ErrorBoundary from \"./ErrorBoundary\";\n\nconst effectValue = ANIMATION_EFFECTS.fr;\n\n/**\n* Composant responsable du rendu des images animées.\n*/\nclass BaseCanvasKonvaAnimatedObject extends Component {\n  /**\n  * Variable d'état du composant.\n  */\n  state = {\n    fromValue : {},\n    toValue : {},\n    currentObject : {},\n    reverseSpring: false,\n  };\n\n\n  /**\n  * Constructeur du composant.\n  * @constructor\n  */\n  constructor(props){\n    super(props);\n    this.state = {\n      fromValue : {},\n      toValue : {},\n      currentObject : {},\n    };\n  }\n\n  /**\n  * Fonction de la phase \"Avant montage\" du cycle de vie du composant.\n  */\n  componentWillMount(){\n    this.currentObject = this.props.animatedObject;\n    this.updateAnimationFromValue();\n    this.updateAnimationToValue();\n  }\n  /**\n  * Fonction de la phase \"Avant démontage\" du cycle de vie du composant.\n  */\n  componentWillUnmount(){\n\n  }\n\n  /**\n  * Fonction ayant la responsabilité de faire rien du tout.\n  */\n  doNothing = () => {};\n\n  /**\n  * Mise à jour des paramètres de l'état initial de l'objet à animer.\n  */\n  updateAnimationFromValue = () => {\n    this.newX = (this.currentObject.x/this.props.creationBoardWidth)*this.props.windowWidth;\n    this.newY = (this.currentObject.y/this.props.creationBoardHeight)*this.props.windowHeight;\n    this.newWidth = (this.currentObject.width/this.props.creationBoardWidth)*this.props.windowWidth;\n    this.newHeight = (this.currentObject.height/this.props.creationBoardHeight)*this.props.windowHeight;\n\n    const enterEffect = this.currentObject.enterEffect;\n    var xpos = 0, ypos = 0;\n    switch(enterEffect){\n      case effectValue.FROMRIGHT:\n        xpos = this.props.windowWidth + this.newWidth*1.1;\n        this.setState({ fromValue : { x:xpos } });\n        break;\n      case effectValue.FROMLEFT:\n        xpos = -this.newWidth*1.1;\n        this.setState({ fromValue : { x:xpos } });\n        break;\n      case effectValue.FROMTOP:\n        ypos = -this.newHeight*1.1;\n        this.setState({ fromValue : { y:ypos } });\n        break;\n      case effectValue.FROMBOTTOM:\n        ypos = this.props.windowHeight + this.newHeight*1.1;\n        this.setState({ fromValue : { y:ypos } });\n        break;\n      case effectValue.DEFAULT:\n        this.setState({ fromValue : { opacity:0 } });\n        break;\n      default :\n        this.setState({ fromValue : { opacity:0 } });\n    }\n  };\n  /**\n  * Mise à jour des paramètres de l'état final de l'objet à animer.\n  */\n  updateAnimationToValue =  () => {\n    this.setState({\n      toValue: {\n        x:this.newX,\n        y:this.newY,\n        width:this.newWidth,\n        height:this.newHeight,\n        rotation:this.currentObject.rotation,\n        opacity:1\n      }\n    });\n  };\n\n  /**\n  * Affiche les éléments d'interface du composant.\n  */\n  render() {\n    let toValue = this.state.toValue,\n        fromValue = this.state.fromValue,\n        entranceDelay = this.currentObject.entranceDelay,\n        entranceDuration = this.currentObject.entranceDuration,\n        exitDelay = this.currentObject.exitDelay,\n        exitDuration = this.currentObject.exitDuration;\n\n    /*console.log(fromValue);\n    console.log(toValue);\n    console.log(this.props.animatedObject.entranceDelay);\n    console.log(this.props.animatedObject.entranceDuration);*/\n\n    const PubPointAnimator = Keyframes.Spring(\n      async (next, cancel, ownProps) => {\n        await delay(entranceDelay)\n        await next({ from:fromValue, to:toValue, duration:entranceDuration })\n        await delay(exitDelay)\n        await next({ from:toValue, to:fromValue, duration:exitDuration })\n      });\n\n    const animationRenderer = () => {\n      let objectType = this.props.type;\n      switch(objectType){\n        case \"character\":\n        console.log(\"Character\");\n         return <PubPointAnimator onFrame={this.props.captureFrameCallback}>\n                 {props => <BaseCanvasKonvaImage  imageSrc={this.currentObject.image}\n                                                  type={this.currentObject.type}\n                                                  assetIndex={this.props.objectIndex}\n                                                  onAssetClicked={this.doNothing}\n                                                  onPositionChange={this.doNothing}\n                                                  onTransformChange={this.doNothing}\n                                                  {...props}/>}\n                </PubPointAnimator>;\n\n         case \"object\":\n          return <PubPointAnimator onFrame={this.props.captureFrameCallback}>\n                  {props => <BaseCanvasKonvaImage  imageSrc={this.currentObject.image}\n                                                   type={this.currentObject.type}\n                                                   assetIndex={this.props.objectIndex}\n                                                   onAssetClicked={this.doNothing}\n                                                   onPositionChange={this.doNothing}\n                                                   onTransformChange={this.doNothing}\n                                                   {...props}/>}\n                 </PubPointAnimator>;\n\n          case \"landscape\":\n           return <PubPointAnimator onFrame={this.props.captureFrameCallback}>\n                   {props => <BaseCanvasKonvaImage  imageSrc={this.currentObject.image}\n                                                    type={this.currentObject.type}\n                                                    assetIndex={this.props.objectIndex}\n                                                    onAssetClicked={this.doNothing}\n                                                    onPositionChange={this.doNothing}\n                                                    onTransformChange={this.doNothing}\n                                                    { ...props } />}\n                  </PubPointAnimator>;\n\n           case GEOMETRIC_FORMS.fr.RECTANGLE:\n            console.log(GEOMETRIC_FORMS.fr.RECTANGLE);\n            return <PubPointAnimator onFrame={this.props.captureFrameCallback}>\n                    {props => <Rect  { ...props }/>}\n                   </PubPointAnimator>;\n\n            case GEOMETRIC_FORMS.fr.CIRCLE:\n             return <Circle  x={parseInt(this.props.x)}\n                             y={parseInt(this.props.y)}\n                             radius={parseInt(this.props.radius)}\n                             fill={this.props.fill}\n                             stroke={this.props.stroke}\n                             strokeWidth={parseInt(this.props.strokeWidth)}\n                             className=\"GeometricForm\"\n                             onPositionChange={this.props.onPositionChange}\n                             onTransformChange={this.props.onTransformChange}\n                             onClick={this.props.onAssetClicked}   />;\n\n           case GEOMETRIC_FORMS.fr.ELLIPSE:\n            return <Ellipse  x={parseInt(this.props.x)}\n                             y={parseInt(this.props.y)}\n                             radius={{x: parseInt(this.props.radiusX), y:parseInt(this.props.radiusY)}}\n                             fill={this.props.fill}\n                             stroke={this.props.stroke}\n                             strokeWidth={parseInt(this.props.strokeWidth)}\n                             className=\"GeometricForm\"\n                             onPositionChange={this.props.onPositionChange}\n                             onTransformChange={this.props.onTransformChange}\n                             onClick={this.props.onAssetClicked}   />;\n\n           case GEOMETRIC_FORMS.fr.REGULARPOLYGON:\n            return <RegularPolygon  x={parseInt(this.props.x)}\n                                    y={parseInt(this.props.y)}\n                                    sides={parseInt(this.props.sides)}\n                                    radius={parseInt(this.props.radius)}\n                                    fill={this.props.fill}\n                                    stroke={this.props.stroke}\n                                    strokeWidth={parseInt(this.props.strokeWidth)}\n                                    className=\"GeometricForm\"\n                                    onPositionChange={this.props.onPositionChange}\n                                    onTransformChange={this.props.onTransformChange}\n                                    onClick={this.props.onAssetClicked}   />;\n\n            case \"textfield\":\n             return <Text  fontSize={parseInt(this.props.fontSize)}\n                           text={this.props.inputText}\n                           fill={this.props.color}\n                           x={parseInt(this.props.xValue)}\n                           y={parseInt(this.props.yValue)}\n                           fontFamily={this.props.fontFamily}\n                           align={this.props.align}\n                           width={parseInt(this.props.width)}\n                           name={this.props.name}\n                           type={this.props.type}\n                           className=\"Textfield\"\n                           onPositionChange={this.props.onPositionChange}\n                           onTransformChange={this.props.onTransformChange}\n                           onClick={this.props.onAssetClicked} />;\n      }\n    };\n\n    return (\n      <ErrorBoundary>\n        { animationRenderer() }\n      </ErrorBoundary>\n    );\n  }\n}\n\nexport default BaseCanvasKonvaAnimatedObject;\n"]},"metadata":{},"sourceType":"module"}